{
  "version": 3,
  "sources": ["../src/store/models/wc.ts", "../src/store/wc-models.ts"],
  "sourcesContent": ["import {createModel} from \"@rematch/core\";\nimport type {WooCommerceRootModel} from \"../wc-models\";\nimport {triggerJQuery} from \"../../utils/triggers\";\n\nconst domDataEl = document.getElementById('udesly-wc-mini-cart-elements');\nconst domState = JSON.parse(domDataEl.textContent);\n\nlet timeout;\n\nexport const woocommerce = createModel<WooCommerceRootModel>()({\n    state: {\n        count: domState.count || 0,\n        subtotal: domState.subtotal || \"\",\n        total: domState.total || \"\",\n        items: domState.items || [],\n        notices: domState.notices || [],\n        cartOpen: false,\n        checkout: domState.checkout || {}\n    },\n    reducers: {\n        toggleCart(state) {\n            return {...state, cartOpen: !state.cartOpen};\n        },\n        cartChanged(state) {\n            const domDataEl = document.getElementById('udesly-wc-mini-cart-elements');\n            const domState = JSON.parse(domDataEl.textContent);\n            return {...state, ...domState};\n        },\n        removedFromCart(state, payload) {\n            triggerJQuery('removed_from_cart', [ payload.fragments, payload.cart_hash ]);\n            triggerJQuery('update_checkout');\n            return state;\n        },\n        ajaxError(state, payload) {\n            console.error(payload);\n            return state;\n        },\n        addedToCart(state, payload) {\n            triggerJQuery('added_to_cart', [ payload.fragments, payload.cart_hash ]);\n            triggerJQuery('update_checkout');\n            return state;\n        },\n        appliedCoupon(state, payload) {\n            triggerJQuery( 'applied_coupon_in_checkout', [ payload.coupon_code ] );\n            triggerJQuery( 'update_checkout', { update_shipping_method: false } );\n            if (!state.checkout.coupons) {\n                state.checkout.coupons = [];\n            }\n            state.checkout.coupons.push(payload)\n            if (state.checkout.coupons.length > 0) {\n                const reviewTable = document.querySelector('.w-commerce-commercecheckoutordersummarywrapper');\n                if (reviewTable) {\n                    reviewTable.scrollIntoView({behavior: \"smooth\", block: \"center\"})\n                }\n            }\n            return {...state};\n        },\n        updateCheckout(state) {\n            document.body.classList.add('updating-checkout');\n            return state;\n        },\n        checkoutUpdated(state) {\n            document.body.classList.remove('updating-checkout');\n            return state;\n        },\n        updatedCartQuantity(state, payload) {\n            triggerJQuery('added_to_cart', [ payload.fragments, payload.cart_hash ]);\n            triggerJQuery('update_checkout');\n            return state;\n        },\n        checkoutNotice(state, payload) {\n\n            return state;\n        },\n        invalidCoupon(state, payload) {\n            console.log(payload);\n\n            state.checkout.coupons = [];\n\n            return {...state};\n        }\n    },\n    effects: dispatch => ({\n      async removeFromCart(payload, state) {\n          const data = new FormData();\n          data.set('cart_item_key', payload);\n          const response = await fetch(window.udesly_frontend_options.wc.wc_ajax_url.replace( '%%endpoint%%', 'remove_from_cart' ), {\n              method: \"POST\",\n              body: data\n          });\n          if (response.ok) {\n              const respData = await response.json();\n              if (respData.success && respData.success === false) {\n                  dispatch.woocommerce.ajaxError(response.status);\n              } else {\n                  dispatch.woocommerce.removedFromCart(respData);\n              }\n          } else {\n              dispatch.woocommerce.ajaxError(response.status);\n          }\n      },\n        async applyCoupon(payload, state) {\n            jQuery && jQuery( '.woocommerce-error, .woocommerce-message' ).remove();\n            const data = new FormData();\n            data.set('security', wc_checkout_params.apply_coupon_nonce);\n            data.set('coupon_code', payload.coupon_code);\n            const response = await fetch(wc_checkout_params.wc_ajax_url.replace( '%%endpoint%%', 'apply_coupon' ), {\n                method: \"POST\",\n                body: data\n            });\n            if (response.ok) {\n                const respData = await response.text();\n                dispatch.woocommerce.checkoutNotice(respData);\n                triggerJQuery( 'update_checkout', { update_shipping_method: false } );\n                dispatch.woocommerce.appliedCoupon({coupon_code: payload.coupon_code, resp: respData});\n            } else {\n                dispatch.woocommerce.ajaxError(response.status);\n            }\n        },\n        async updateCartQuantity(payload, state) {\n            const data = new FormData();\n            data.set('key', payload.key);\n            data.set('quantity', payload.quantity);\n            const response = await fetch(window.udesly_frontend_options.wc.wc_ajax_url.replace( '%%endpoint%%', 'udesly_change_cart_quantity' ), {\n                method: \"POST\",\n                body: data\n            });\n            if (response.ok) {\n                const respData = await response.json();\n                if (respData.success && respData.success === false) {\n                    dispatch.woocommerce.ajaxError(response.status);\n                } else {\n                    dispatch.woocommerce.removedFromCart(respData);\n                }\n            } else {\n                dispatch.woocommerce.ajaxError(response.status);\n            }\n        },\n      async addToCart(payload, state) {\n          let {type, variation_id, product_id, quantity, el, submitter, buyNow} = payload;\n          if(timeout) {\n              clearTimeout(timeout);\n          }\n          el.parentElement.querySelectorAll('.w-commerce-commerceaddtocarterror').forEach(e => e.style.display = \"none\");\n          el.parentElement.classList.add('adding-to-cart');\n\n          if (submitter.disabled) {\n              return;\n          }\n\n          if (submitter.tagName == \"BUTTON\") {\n              if (!submitter.dataset['default']) {\n                  submitter.dataset['default'] = submitter.textContent;\n              }\n              submitter.textContent = submitter.dataset['loadingText'];\n              submitter.disabled = true;\n          }\n\n          if (type == \"variable\") {\n              if (variation_id !== \"0\") {\n                  product_id = variation_id;\n              }\n          }\n\n          const data = new FormData();\n          data.set('quantity', quantity);\n          data.set('product_id', product_id);\n\n          const response = await fetch(window.udesly_frontend_options.wc.wc_ajax_url.replace( '%%endpoint%%', 'udesly_add_to_cart' ), {\n              method: \"POST\",\n              body: data\n          });\n          if (response.ok) {\n              const respData = await response.json();\n              if (respData.error && respData.error === true) {\n                  dispatch.woocommerce.ajaxError(respData.error_message || respData);\n                  el.parentElement.querySelectorAll('[data-node-type=\"commerce-add-to-cart-error\"]').forEach(e => e.innerHTML = respData.error_message);\n                  el.parentElement.querySelectorAll('.w-commerce-commerceaddtocarterror').forEach(e => e.style.display = \"\");\n                  timeout = setTimeout(() => {\n                      el.parentElement.querySelectorAll('.w-commerce-commerceaddtocarterror').forEach(e => e.style.display = \"none\");\n                  }, 10000)\n              } else {\n                  if (buyNow) {\n                      window.location = window.udesly_frontend_options.wc.checkout_url;\n                  } else {\n                      dispatch.woocommerce.addedToCart(respData);\n                  }\n              }\n          } else {\n              dispatch.woocommerce.ajaxError(response.status);\n          }\n          el.parentElement.classList.remove('adding-to-cart');\n          if (submitter.tagName == \"BUTTON\") {\n              submitter.textContent = submitter.dataset['default'];\n              submitter.disabled = false;\n          }\n      }\n    })\n})", "import {Models} from \"@rematch/core\";\nimport { woocommerce } from './models/wc'\nimport {wordpress} from \"./models/wordpress\";\n\nexport interface WooCommerceRootModel extends Models<WooCommerceRootModel> {\n    woocommerce: typeof woocommerce,\n    wordpress: typeof wordpress\n}\n\nexport const models: WooCommerceRootModel = { woocommerce, wordpress }\n"],
  "mappings": "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",
  "names": []
}
