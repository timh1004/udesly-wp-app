{
  "version": 3,
  "sources": ["../src/store/models/wc.ts", "../src/store/wc-models.ts"],
  "sourcesContent": ["import {createModel} from \"@rematch/core\";\nimport type {WooCommerceRootModel} from \"../wc-models\";\nimport {triggerJQuery} from \"../../utils/triggers\";\n\nconst domDataEl = document.getElementById('udesly-wc-mini-cart-elements');\nconst domState = JSON.parse(domDataEl.textContent);\n\nexport const woocommerce = createModel<WooCommerceRootModel>()({\n    state: {\n        count: domState.count || 0,\n        subtotal: domState.subtotal || \"\",\n        total: domState.total || \"\",\n        items: domState.items || [],\n        cartOpen: false\n    },\n    reducers: {\n        toggleCart(state) {\n            return {...state, cartOpen: !state.cartOpen};\n        },\n        cartChanged(state) {\n            const domDataEl = document.getElementById('udesly-wc-mini-cart-elements');\n            const domState = JSON.parse(domDataEl.textContent);\n            return {...state, ...domState};\n        },\n        removedFromCart(state, payload) {\n            triggerJQuery('removed_from_cart', [ payload.fragments, payload.cart_hash ]);\n            return state;\n        },\n        ajaxError(state, payload) {\n            console.error(payload);\n            return state;\n        },\n        addedToCart(state, payload) {\n            triggerJQuery('added_to_cart', [ payload.fragments, payload.cart_hash ]);\n            return state;\n        }\n    },\n    effects: dispatch => ({\n      async removeFromCart(payload, state) {\n          const data = new FormData();\n          data.set('cart_item_key', payload);\n          const response = await fetch(window.udesly_frontend_options.wc.wc_ajax_url.replace( '%%endpoint%%', 'remove_from_cart' ), {\n              method: \"POST\",\n              body: data\n          });\n          if (response.ok) {\n              const respData = await response.json();\n              if (respData.success && respData.success === false) {\n                  dispatch.woocommerce.ajaxError(response.status);\n              } else {\n                  dispatch.woocommerce.removedFromCart(respData);\n              }\n          } else {\n              dispatch.woocommerce.ajaxError(response.status);\n          }\n      },\n      async addToCart(payload, state) {\n          let {type, variation_id, product_id, quantity, el, submitter} = payload;\n          el.classList.add('adding-to-cart');\n\n          if (submitter.disabled) {\n              return;\n          }\n\n          if (submitter.tagName == \"BUTTON\") {\n              if (!submitter.dataset['default']) {\n                  submitter.dataset['default'] = submitter.textContent;\n              }\n              submitter.textContent = submitter.dataset['loadingText'];\n              submitter.disabled = true;\n          }\n\n          if (type == \"variable\") {\n              if (variation_id !== \"0\") {\n                  product_id = variation_id;\n              }\n          }\n\n          const data = new FormData();\n          data.set('quantity', quantity);\n          data.set('product_id', product_id);\n\n          const response = await fetch(window.udesly_frontend_options.wc.wc_ajax_url.replace( '%%endpoint%%', 'add_to_cart' ), {\n              method: \"POST\",\n              body: data\n          });\n          if (response.ok) {\n              const respData = await response.json();\n              if (respData.success && respData.success === false) {\n                  dispatch.woocommerce.ajaxError(response.status);\n              } else {\n                  dispatch.woocommerce.addedToCart(respData);\n              }\n          } else {\n              dispatch.woocommerce.ajaxError(response.status);\n          }\n\n          if (submitter.tagName == \"BUTTON\") {\n              submitter.textContent = submitter.dataset['default'];\n              submitter.disabled = false;\n          }\n      }\n    })\n})", "import {Models} from \"@rematch/core\";\nimport { woocommerce } from './models/wc'\n\nexport interface WooCommerceRootModel extends Models<WooCommerceRootModel> {\n    woocommerce: typeof woocommerce\n}\n\nexport const models: WooCommerceRootModel = { woocommerce }\n"],
  "mappings": ";;;;;;;;;AAIA,IAAM,YAAY,SAAS,eAAe;AAC1C,IAAM,WAAW,KAAK,MAAM,UAAU;AAE/B,IAAM,cAAc,cAAoC;AAAA,EAC3D,OAAO;AAAA,IACH,OAAO,SAAS,SAAS;AAAA,IACzB,UAAU,SAAS,YAAY;AAAA,IAC/B,OAAO,SAAS,SAAS;AAAA,IACzB,OAAO,SAAS,SAAS;AAAA,IACzB,UAAU;AAAA;AAAA,EAEd,UAAU;AAAA,IACN,WAAW,OAAO;AACd,aAAO,IAAI,OAAO,UAAU,CAAC,MAAM;AAAA;AAAA,IAEvC,YAAY,OAAO;AACf,YAAM,aAAY,SAAS,eAAe;AAC1C,YAAM,YAAW,KAAK,MAAM,WAAU;AACtC,aAAO,IAAI,UAAU;AAAA;AAAA,IAEzB,gBAAgB,OAAO,SAAS;AAC5B,oBAAc,qBAAqB,CAAE,QAAQ,WAAW,QAAQ;AAChE,aAAO;AAAA;AAAA,IAEX,UAAU,OAAO,SAAS;AACtB,cAAQ,MAAM;AACd,aAAO;AAAA;AAAA,IAEX,YAAY,OAAO,SAAS;AACxB,oBAAc,iBAAiB,CAAE,QAAQ,WAAW,QAAQ;AAC5D,aAAO;AAAA;AAAA;AAAA,EAGf,SAAS,cAAa;AAAA,UACd,eAAe,SAAS,OAAO;AACjC,YAAM,OAAO,IAAI;AACjB,WAAK,IAAI,iBAAiB;AAC1B,YAAM,WAAW,MAAM,MAAM,OAAO,wBAAwB,GAAG,YAAY,QAAS,gBAAgB,qBAAsB;AAAA,QACtH,QAAQ;AAAA,QACR,MAAM;AAAA;AAEV,UAAI,SAAS,IAAI;AACb,cAAM,WAAW,MAAM,SAAS;AAChC,YAAI,SAAS,WAAW,SAAS,YAAY,OAAO;AAChD,mBAAS,YAAY,UAAU,SAAS;AAAA,eACrC;AACH,mBAAS,YAAY,gBAAgB;AAAA;AAAA,aAEtC;AACH,iBAAS,YAAY,UAAU,SAAS;AAAA;AAAA;AAAA,UAG1C,UAAU,SAAS,OAAO;AAC5B,UAAI,CAAC,MAAM,cAAc,YAAY,UAAU,IAAI,aAAa;AAChE,SAAG,UAAU,IAAI;AAEjB,UAAI,UAAU,UAAU;AACpB;AAAA;AAGJ,UAAI,UAAU,WAAW,UAAU;AAC/B,YAAI,CAAC,UAAU,QAAQ,YAAY;AAC/B,oBAAU,QAAQ,aAAa,UAAU;AAAA;AAE7C,kBAAU,cAAc,UAAU,QAAQ;AAC1C,kBAAU,WAAW;AAAA;AAGzB,UAAI,QAAQ,YAAY;AACpB,YAAI,iBAAiB,KAAK;AACtB,uBAAa;AAAA;AAAA;AAIrB,YAAM,OAAO,IAAI;AACjB,WAAK,IAAI,YAAY;AACrB,WAAK,IAAI,cAAc;AAEvB,YAAM,WAAW,MAAM,MAAM,OAAO,wBAAwB,GAAG,YAAY,QAAS,gBAAgB,gBAAiB;AAAA,QACjH,QAAQ;AAAA,QACR,MAAM;AAAA;AAEV,UAAI,SAAS,IAAI;AACb,cAAM,WAAW,MAAM,SAAS;AAChC,YAAI,SAAS,WAAW,SAAS,YAAY,OAAO;AAChD,mBAAS,YAAY,UAAU,SAAS;AAAA,eACrC;AACH,mBAAS,YAAY,YAAY;AAAA;AAAA,aAElC;AACH,iBAAS,YAAY,UAAU,SAAS;AAAA;AAG5C,UAAI,UAAU,WAAW,UAAU;AAC/B,kBAAU,cAAc,UAAU,QAAQ;AAC1C,kBAAU,WAAW;AAAA;AAAA;AAAA;AAAA;;;AC5F5B,IAAM,SAA+B,CAAE;",
  "names": []
}
