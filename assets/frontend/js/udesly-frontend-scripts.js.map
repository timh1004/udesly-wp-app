{
  "version": 3,
  "sources": ["../src/store/index.ts", "../src/utils/udesly.ts", "../src/utils/init-udesly.ts", "../src/wp/index.ts", "../src/udesly-frontend-scripts.ts"],
  "sourcesContent": ["import { init } from '@rematch/core'\n\nexport async function initStore(woocommerce = false) {\n\n    const module = woocommerce ? await import('./wc-models') : await import('./models');\n\n    return init({models: module.models,\n        name: woocommerce? \"WP/WC Store\" : \"WP Store\",\n        redux: {\n        devtoolOptions: {\n            disabled: !DEV\n        }\n    },\n    plugins: [plugin()]});\n}\n\nconst plugin = () => ({\n    createMiddleware: rematchBag => (store) => (next) => (action) => {\n            const { type: actionType, payload } = action;\n            window.Udesly.emit(actionType, payload);\n            return next(action);\n        },\n})\n", "import type {RematchStore} from \"@rematch/core\";\nimport type {WooCommerceRootModel} from \"../store/wc-models\";\nimport type {RootModel} from \"../store/models\";\n\nexport default class Udesly<T = WooCommerceRootModel | RootModel> {\n    private eventTarget: EventTarget;\n\n    constructor(description: string = \"\", public store: RematchStore<T>) {\n        this.eventTarget = document.appendChild(document.createComment(description));\n    }\n\n    on(type: string, listener: (data: any) => void) {\n        this._listen(type, listener);\n    }\n\n    getState() {\n        return this.store.getState();\n    }\n\n    dispatch(type: string, payload?: any) {\n       return this.store.dispatch({type, payload});\n    }\n\n    private _listen(type: string, listener: (data: any) => void, options?: {}) {\n        this.eventTarget.addEventListener<CustomEvent>(type, (evt: CustomEvent) => {\n            listener(evt.detail)\n        }, options);\n    }\n\n    once(type: string, listener: (data: any) => void) {\n       this._listen(type, listener, {once: true});\n    }\n\n    off(type: string, listener: (data:any) => void) {\n        this.eventTarget.removeEventListener(type, listener);\n    }\n\n    emit(type: string, payload: any) {\n        setTimeout(() => {\n            this.eventTarget.dispatchEvent(new CustomEvent(type, { detail: payload }));\n        }, 1);\n    }\n}", "import Udesly from \"./udesly\";\nimport type {WooCommerceRootModel} from \"../store/wc-models\";\nimport type {RootModel} from \"../store/models\";\nimport type {RematchStore} from \"@rematch/core\";\n\nexport default function initUdesly<T = WooCommerceRootModel | RootModel>(store: RematchStore<T>) {\n    const funcs = Array.isArray(window.Udesly) ? window.Udesly : [];\n\n    const u = new Udesly<T>(\"udesly\", store);\n\n    window.Udesly = u;\n    funcs.forEach(fn => fn());\n\n    return u;\n}", "import type Udesly from \"../utils/udesly\";\nimport type {RootModel} from \"../store/models\";\n\nconst CURRENT_CLASSNAME = \"w--current\";\n\nexport const addCurrentClassToLinks = () => {\n    const currentPath = window.location.toString();\n\n    document.querySelectorAll(`a[href=\"${currentPath.slice(0,-1)}\"],a[href=\"${currentPath}\"]`).forEach( a => {\n        a.classList.add(CURRENT_CLASSNAME);\n    })\n}\n\nexport default function wp(udesly: Udesly<RootModel>) {\n    addCurrentClassToLinks();\n}", "import {initStore} from \"./store\";\nimport initUdesly from \"./utils/init-udesly\";\nimport wp from \"./wp\";\n\nimport type {RootModel} from \"./store/models\";\nimport type {RematchStore} from \"@rematch/core\";\nimport type {WooCommerceRootModel} from \"./store/wc-models\";\nimport type Udesly from \"./utils/udesly\";\n\nif (window.safari) {\n    var lastBtn = null\n    document.addEventListener('click',function(e){\n        if (!e.target.closest) return;\n        lastBtn = e.target.closest('button, input[type=submit]');\n    }, true);\n    document.addEventListener('submit',function(e){\n        if (e.submitter) return;\n        var canditates = [document.activeElement, lastBtn];\n        for (var i=0; i < canditates.length; i++) {\n            var candidate = canditates[i];\n            if (!candidate) continue;\n            if (!candidate.form) continue;\n            if (!candidate.matches('button, input[type=button], input[type=image]')) continue;\n            e.submitter = candidate;\n            return;\n        }\n        e.submitter = e.target.querySelector('button, input[type=button], input[type=image]')\n    }, true);\n}\n\n(async() => {\n    const woocommerce = window.udesly_frontend_options.plugins.woocommerce;\n    const store = await initStore(woocommerce)\n\n    const udesly = woocommerce ?\n        initUdesly<WooCommerceRootModel>(store as RematchStore<WooCommerceRootModel>)\n       : initUdesly<RootModel>(store as RematchStore<RootModel>);\n\n\n    wp(udesly as Udesly<RootModel>);\n\n    if (woocommerce) {\n        const module = await import('./wc/index');\n        await module.default(udesly as Udesly<WooCommerceRootModel>)\n    }\n\n})();\n"],
  "mappings": ";;;;;;AAEA,yBAAgC,cAAc,OAAO;AAEjD,QAAM,SAAS,cAAc,MAAM,OAAO,6BAAiB,MAAM,OAAO;AAExE,SAAO,KAAK;AAAA,IAAC,QAAQ,OAAO;AAAA,IACxB,MAAM,cAAa,gBAAgB;AAAA,IACnC,OAAO;AAAA,MACP,gBAAgB;AAAA,QACZ,UAAU;AAAA;AAAA;AAAA,IAGlB,SAAS,CAAC;AAAA;AAAA;AAGd,IAAM,SAAS,MAAO;AAAA,EAClB,kBAAkB,gBAAc,CAAC,UAAU,CAAC,SAAS,CAAC,WAAW;AACzD,UAAM,CAAE,MAAM,YAAY,WAAY;AACtC,WAAO,OAAO,KAAK,YAAY;AAC/B,WAAO,KAAK;AAAA;AAAA;;;AChBxB,mBAAkE;AAAA,EAG9D,YAAY,cAAsB,IAAW,OAAwB;AAAxB;AACzC,SAAK,cAAc,SAAS,YAAY,SAAS,cAAc;AAAA;AAAA,EAGnE,GAAG,MAAc,UAA+B;AAC5C,SAAK,QAAQ,MAAM;AAAA;AAAA,EAGvB,WAAW;AACP,WAAO,KAAK,MAAM;AAAA;AAAA,EAGtB,SAAS,MAAc,SAAe;AACnC,WAAO,KAAK,MAAM,SAAS,CAAC,MAAM;AAAA;AAAA,EAG7B,QAAQ,MAAc,UAA+B,SAAc;AACvE,SAAK,YAAY,iBAA8B,MAAM,CAAC,QAAqB;AACvE,eAAS,IAAI;AAAA,OACd;AAAA;AAAA,EAGP,KAAK,MAAc,UAA+B;AAC/C,SAAK,QAAQ,MAAM,UAAU,CAAC,MAAM;AAAA;AAAA,EAGvC,IAAI,MAAc,UAA8B;AAC5C,SAAK,YAAY,oBAAoB,MAAM;AAAA;AAAA,EAG/C,KAAK,MAAc,SAAc;AAC7B,eAAW,MAAM;AACb,WAAK,YAAY,cAAc,IAAI,YAAY,MAAM,CAAE,QAAQ;AAAA,OAChE;AAAA;AAAA;AApCX,IAAO,iBAAP;;;ACCe,oBAA0D,OAAwB;AAC7F,QAAM,QAAQ,MAAM,QAAQ,OAAO,UAAU,OAAO,SAAS;AAE7D,QAAM,IAAI,IAAI,eAAU,UAAU;AAElC,SAAO,SAAS;AAChB,QAAM,QAAQ,QAAM;AAEpB,SAAO;AAAA;;;ACVX,IAAM,oBAAoB;AAEnB,IAAM,yBAAyB,MAAM;AACxC,QAAM,cAAc,OAAO,SAAS;AAEpC,WAAS,iBAAiB,WAAW,YAAY,MAAM,GAAE,iBAAiB,iBAAiB,QAAS,OAAK;AACrG,MAAE,UAAU,IAAI;AAAA;AAAA;AAIT,YAAY,QAA2B;AAClD;AAAA;;;ACLJ,IAAI,OAAO,QAAQ;AACX,YAAU;AACd,WAAS,iBAAiB,SAAQ,SAAS,GAAE;AACzC,QAAI,CAAC,EAAE,OAAO;AAAS;AACvB,cAAU,EAAE,OAAO,QAAQ;AAAA,KAC5B;AACH,WAAS,iBAAiB,UAAS,SAAS,GAAE;AAC1C,QAAI,EAAE;AAAW;AACjB,QAAI,aAAa,CAAC,SAAS,eAAe;AAC1C,aAAS,IAAE,GAAG,IAAI,WAAW,QAAQ,KAAK;AACtC,UAAI,YAAY,WAAW;AAC3B,UAAI,CAAC;AAAW;AAChB,UAAI,CAAC,UAAU;AAAM;AACrB,UAAI,CAAC,UAAU,QAAQ;AAAkD;AACzE,QAAE,YAAY;AACd;AAAA;AAEJ,MAAE,YAAY,EAAE,OAAO,cAAc;AAAA,KACtC;AAAA;AAjBC;AAoBR,AAAC,aAAW;AACR,QAAM,cAAc,OAAO,wBAAwB,QAAQ;AAC3D,QAAM,QAAQ,MAAM,UAAU;AAE9B,QAAM,SAAS,cACX,WAAiC,SAChC,WAAsB;AAG3B,KAAG;AAEH,MAAI,aAAa;AACb,UAAM,SAAS,MAAM,OAAO;AAC5B,UAAM,OAAO,QAAQ;AAAA;AAAA;",
  "names": []
}
