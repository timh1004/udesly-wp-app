{
  "version": 3,
  "sources": ["../src/wc/add-to-cart.ts", "../src/wc/index.ts"],
  "sourcesContent": ["import type Udesly from \"../utils/udesly\";\nimport type {WooCommerceRootModel} from \"../store/wc-models\";\nimport {getElementsByDataNodeType} from \"../utils/webflow\";\n\n\nfunction initAddToCarts(udesly: Udesly<WooCommerceRootModel>) {\n    getElementsByDataNodeType('commerce-add-to-cart-form').forEach( addToCartForm => {\n        const addToCart = addToCartForm.parentElement;\n\n        const productType = addToCart.getAttribute('data-product-type');\n\n        if (addToCartForm.__udy_inited) {\n            return;\n        }\n\n        if (productType == \"simple\" || productType == \"variable\") {\n            addToCartForm.__udy_inited = true;\n            addToCartForm.querySelectorAll('[data-node-type=\"commerce-buy-now-button\"]').forEach( buyNow => {\n                buyNow.addEventListener('click', (e) => {\n                    e.preventDefault();\n                    udesly.dispatch('woocommerce/addToCart', {...addToCartForm._udeslyGetData(), type: productType, buyNow: true, el: addToCartForm, submitter: buyNow})\n                })\n            })\n            addToCartForm.addEventListener('submit', (e) => {\n                e.preventDefault();\n                udesly.dispatch('woocommerce/addToCart', {...addToCartForm._udeslyGetData(), type: productType, buyNow: false, el: addToCartForm, submitter: addToCartForm.querySelector('[type=\"submit\"]')})\n            })\n        }\n\n        switch (productType) {\n            case \"simple\":\n                addToCartForm._udeslyGetData = function() {\n                    const product_id = this.dataset.skuId;\n                    const quantity = this.querySelector('[name=\"quantity\"]').value;\n                    return {product_id, quantity};\n                }\n                break;\n            case \"variable\":\n                addToCartForm._udeslyGetData = function() {\n                    return Object.fromEntries(new FormData(this).entries());\n                }\n                break;\n        }\n\n    });\n}\n\nexport function manageAddToCarts(udesly: Udesly<WooCommerceRootModel>) {\n\n    initAddToCarts(udesly);\n\n    udesly.on(\"wordpress/ajaxPagination\", () => {\n        initAddToCarts(udesly);\n    });\n\n}", "import type Udesly from \"../utils/udesly\";\nimport type {WooCommerceRootModel} from \"../store/wc-models\";\nimport {getElementsByDataNodeType} from \"../utils/webflow\";\nimport {onJQueryEvent} from \"../utils/triggers\";\nimport {manageAddToCarts} from \"./add-to-cart\";\n\nexport default async function wc(udesly: Udesly<WooCommerceRootModel>) {\n\n    const miniCartsWrappers = getElementsByDataNodeType(\"commerce-cart-wrapper\");\n\n    if (miniCartsWrappers) {\n        import('./mini-cart').then( miniCartModule => {\n            miniCartsWrappers.forEach(wrapper => new miniCartModule.default(udesly, wrapper));\n        })\n    }\n\n    onJQueryEvent('wc_fragments_refreshed wc_fragments_loaded', () => {\n        udesly.dispatch('woocommerce/cartChanged');\n    })\n\n\n    manageAddToCarts(udesly);\n}"],
  "mappings": ";;;;;;;;;AAKA,wBAAwB,QAAsC;AAC1D,4BAA0B,6BAA6B,QAAS,mBAAiB;AAC7E,UAAM,YAAY,cAAc;AAEhC,UAAM,cAAc,UAAU,aAAa;AAE3C,QAAI,cAAc,cAAc;AAC5B;AAAA;AAGJ,QAAI,eAAe,YAAY,eAAe,YAAY;AACtD,oBAAc,eAAe;AAC7B,oBAAc,iBAAiB,8CAA8C,QAAS,YAAU;AAC5F,eAAO,iBAAiB,SAAS,CAAC,MAAM;AACpC,YAAE;AACF,iBAAO,SAAS,yBAAyB,IAAI,cAAc,kBAAkB,MAAM,aAAa,QAAQ,MAAM,IAAI,eAAe,WAAW;AAAA;AAAA;AAGpJ,oBAAc,iBAAiB,UAAU,CAAC,MAAM;AAC5C,UAAE;AACF,eAAO,SAAS,yBAAyB,IAAI,cAAc,kBAAkB,MAAM,aAAa,QAAQ,OAAO,IAAI,eAAe,WAAW,cAAc,cAAc;AAAA;AAAA;AAIjL,YAAQ;AAAA,WACC;AACD,sBAAc,iBAAiB,WAAW;AACtC,gBAAM,aAAa,KAAK,QAAQ;AAChC,gBAAM,WAAW,KAAK,cAAc,qBAAqB;AACzD,iBAAO,CAAC,YAAY;AAAA;AAExB;AAAA,WACC;AACD,sBAAc,iBAAiB,WAAW;AACtC,iBAAO,OAAO,YAAY,IAAI,SAAS,MAAM;AAAA;AAEjD;AAAA;AAAA;AAAA;AAMT,0BAA0B,QAAsC;AAEnE,iBAAe;AAEf,SAAO,GAAG,4BAA4B,MAAM;AACxC,mBAAe;AAAA;AAAA;;;AC9CvB,kBAAiC,QAAsC;AAEnE,QAAM,oBAAoB,0BAA0B;AAEpD,MAAI,mBAAmB;AACnB,WAAO,2BAAe,KAAM,oBAAkB;AAC1C,wBAAkB,QAAQ,aAAW,IAAI,eAAe,QAAQ,QAAQ;AAAA;AAAA;AAIhF,gBAAc,8CAA8C,MAAM;AAC9D,WAAO,SAAS;AAAA;AAIpB,mBAAiB;AAAA;",
  "names": []
}
